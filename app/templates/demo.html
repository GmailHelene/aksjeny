{% extends "base.html" %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/demo.css') }}">
{% endblock %}

{% block title %}Demo - Aksjeradar{% endblock %}

{% block content %}
<!-- Trial Expired Banner -->
<div class="alert alert-warning alert-dismissible fade show mb-0" role="alert" id="trial-banner" style="display: none;">
    <div class="container">
        <div class="d-flex align-items-center justify-content-between">
            <div>
                <i class="bi bi-hourglass-split me-2"></i>
                <strong>Din gratis demo varer i 10 minutter</strong> - Oppgrader n√• for full tilgang!
            </div>
            <div class="d-flex gap-2">
                <a href="{{ url_for('main.login') }}" class="btn btn-primary btn-sm" style="background-color: white; color: #0d6efd; border-color: white;">
                    <i class="bi bi-box-arrow-in-right"></i> Logg Inn
                </a>
                <a href="{{ url_for('main.subscription') }}" class="btn btn-outline-light btn-sm">
                    <i class="bi bi-star"></i> Se abonnement
                </a>
            </div>
        </div>
    </div>
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>

<!-- Purple Subscription Banner -->
<div class="alert alert-info mb-0" style="background: linear-gradient(135deg, #6f42c1 0%, #8b5cf6 100%); border: none; border-radius: 0;">
    <div class="container">
        <div class="d-flex align-items-center justify-content-between text-white">
            <div>
                <i class="bi bi-star-fill me-2"></i>
                <strong>F√• full tilgang til alle funksjoner</strong> - Teknisk analyse, AI-anbefalinger og mer!
            </div>
            <div class="d-flex gap-2">
                <a href="{{ url_for('main.subscription') }}" class="btn btn-light btn-sm" style="background-color: white; color: #6f42c1;">
                    <i class="bi bi-crown"></i> Se abonnementer
                </a>
            </div>
        </div>
    </div>
</div>

<div class="hero-section">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-6">
                <h1 class="display-4 fw-bold text-dark mb-4">Velkommen til Aksjeradar Demo</h1>
                <p class="lead text-dark mb-4">Utforsk en forenklet versjon av v√•r kraftige aksjeplattform. Se hva du kan oppn√• med full tilgang!</p>
                <div class="d-flex gap-3 mb-4">
                    <div class="demo-stat">
                        <h3 class="text-primary">50+</h3>
                        <p class="text-muted">Tekniske indikatorer</p>
                    </div>
                    <div class="demo-stat">
                        <h3 class="text-success">AI</h3>
                        <p class="text-muted">Drevne anbefalinger</p>
                    </div>
                    <div class="demo-stat">
                        <h3 class="text-info">24/7</h3>
                        <p class="text-muted">Markedsdata</p>
                    </div>
                </div>
                <div class="d-flex gap-3">
                    <a href="{{ url_for('main.subscription') }}" class="btn btn-primary btn-lg">
                        <i class="bi bi-rocket"></i> F√• full tilgang
                    </a>
                    <a href="{{ url_for('main.register') }}" class="btn btn-outline-primary btn-lg">
                        <i class="bi bi-person-plus"></i> Registrer deg
                    </a>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="demo-preview">
                    <img src="https://via.placeholder.com/600x400/0d6efd/ffffff?text=Aksjeradar+Dashboard" alt="Aksjeradar Dashboard" class="img-fluid rounded shadow">
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Demo Features Section -->
<div class="features-section py-5">
    <div class="container">
        <div class="row text-center mb-5">
            <div class="col-12">
                <h2 class="display-5 fw-bold text-dark">Hva du f√•r med full tilgang</h2>
                <p class="lead text-muted">Sammenlign demo-versjon med full versjon</p>
            </div>
        </div>
        
        <div class="row g-4">
            <!-- Feature 1: See how it works -->
            <div class="col-md-4">
                <div class="feature-card">
                    <div class="feature-icon bg-primary">
                        <i class="bi bi-eye text-white"></i>
                    </div>
                    <h4 class="text-dark">1. Utforsk grensesnittet</h4>
                    <div class="feature-comparison">
                        <div class="demo-version">
                            <span class="badge bg-secondary">Demo</span>
                            <p class="text-muted">Se hvordan plattformen fungerer</p>
                        </div>
                        <div class="full-version">
                            <span class="badge bg-success">Full tilgang</span>
                            <p class="text-success">Alle markeder + realtime data</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Feature 2: Try functions -->
            <div class="col-md-4">
                <div class="feature-card">
                    <div class="feature-icon bg-success">
                        <i class="bi bi-gear text-white"></i>
                    </div>
                    <h4 class="text-dark">2. Test funksjonaliteten</h4>
                    <div class="feature-comparison">
                        <div class="demo-version">
                            <span class="badge bg-secondary">Demo</span>
                            <p class="text-muted">Statiske eksempler p√• analyser</p>
                        </div>
                        <div class="full-version">
                            <span class="badge bg-success">Full tilgang</span>
                            <p class="text-success">Live AI-anbefalinger</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Feature 3: Buy full version -->
            <div class="col-md-4">
                <div class="feature-card">
                    <div class="feature-icon bg-info">
                        <i class="bi bi-cart text-white"></i>
                    </div>
                    <h4 class="text-dark">3. Kj√∏p full versjon</h4>
                    <div class="feature-comparison">
                        <div class="demo-version">
                            <span class="badge bg-secondary">Demo</span>
                            <p class="text-muted">Begrenset funksjonalitet</p>
                        </div>
                        <div class="full-version">
                            <span class="badge bg-success">Full tilgang</span>
                            <p class="text-success">Komplett portef√∏ljeadministrasjon</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Interactive Demo Section -->
<div class="demo-content py-5 bg-light">
    <div class="container">
        <h2 class="text-center mb-5 text-dark">üöÄ Interaktiv Demo - Pr√∏v funksjonene!</h2>
        
        <!-- Live Demo: Stock Analysis -->
        <div class="row g-4 mb-5">
            <div class="col-md-6">
                <div class="demo-widget">
                    <h5 class="text-dark mb-3">üìä Markedsindekser (Demo)</h5>
                    <div class="table-responsive">
                        <table class="table table-sm">
                            <thead>
                                <tr>
                                    <th>Indeks</th>
                                    <th>Verdi</th>
                                    <th>Endring</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% if indices and indices|length > 0 %}
                                    {% for index in indices[:4] %}
                                    <tr>
                                        <td>{{ index.name or index.ticker }}</td>
                                        <td>{{ "%.2f"|format(index.last_price or 0) }}</td>
                                        <td class="{% if (index.change_percent or 0) >= 0 %}text-success{% else %}text-danger{% endif %}">
                                            {{ "%+.1f"|format(index.change_percent or 0) }}%
                                        </td>
                                    </tr>
                                    {% endfor %}
                                {% else %}
                                    <tr>
                                        <td>OSEBX</td>
                                        <td>1,234.56</td>
                                        <td class="text-success">+1.2%</td>
                                    </tr>
                                    <tr>
                                        <td>OBX</td>
                                        <td>987.65</td>
                                        <td class="text-danger">-0.5%</td>
                                    </tr>
                                    <tr>
                                        <td>Nasdaq</td>
                                        <td>15,432.10</td>
                                        <td class="text-success">+0.8%</td>
                                    </tr>
                                    <tr>
                                        <td>S&P 500</td>
                                        <td>4,567.89</td>
                                        <td class="text-success">+0.3%</td>
                                    </tr>
                                {% endif %}
                            </tbody>
                        </table>
                    </div>
                    <!-- Removed lock overlay to make demo functional -->
                    <div class="demo-preview">
                        <small class="text-muted">üí° Dette er live data! Med full tilgang f√•r du alle globale markeder.</small>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6">
                <div class="demo-widget">
                    <h5 class="text-dark mb-3">ü§ñ AI-Anbefalinger (Demo)</h5>
                    <div class="ai-recommendation">
                        <div class="alert alert-info">
                            <strong>Eksempel:</strong> Basert p√• teknisk analyse anbefaler vi √• holde EQUI med kursm√•l 45 NOK.
                        </div>
                        <div class="alert alert-success">
                            <strong>Kj√∏p signal:</strong> DNB viser sterke tekniske indikatorer. RSI: 35 (oversold)
                        </div>
                    </div>
                    <!-- Demo is now interactive - overlay removed -->
                </div>
            </div>
        </div>

        <!-- Demo: Analysis Tools -->
        <div class="row g-4 mb-5">
            <div class="col-12">
                <div class="demo-widget">
                    <h5 class="text-dark mb-3">üîç Analyse-verkt√∏y (Demo)</h5>
                    <div class="row">
                        <div class="col-md-3">
                            <div class="analysis-card">
                                <h6>üìà Teknisk Analyse</h6>
                                <p class="text-muted">Candlestick-m√∏nstre, RSI, MACD, og mer</p>
                                <a href="{{ url_for('analysis.technical') }}" class="btn btn-sm btn-outline-primary">
                                    Pr√∏v n√•
                                </a>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="analysis-card">
                                <h6>ü§ñ AI Prediksjon</h6>
                                <p class="text-muted">Maskinl√¶ring-baserte kursprediksjoner</p>
                                <a href="{{ url_for('features.ai_predictions') }}" class="btn btn-sm btn-outline-primary">
                                    Pr√∏v n√•
                                </a>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="analysis-card">
                                <h6>üìä Warren Buffett</h6>
                                <p class="text-muted">Verdiinvestering-analyse</p>
                                <a href="{{ url_for('analysis.warren_buffett') }}" class="btn btn-sm btn-outline-primary">
                                    Pr√∏v n√•
                                </a>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="analysis-card">
                                <h6>üí° Sentiment</h6>
                                <p class="text-muted">Markedssentiment og nyhetsanalyse</p>
                                <a href="{{ url_for('analysis.sentiment') }}" class="btn btn-sm btn-outline-primary">
                                    Pr√∏v n√•
                                </a>
                            </div>
                        </div>
                    </div>
                    <!-- Analysis tools are now interactive -->
                </div>
            </div>
        </div>

        <!-- Demo: Portfolio Management -->
        <div class="row g-4 mb-5">
            <div class="col-md-6">
                <div class="demo-widget">
                    <h5 class="text-dark mb-3">üíº Portef√∏ljeadministrasjon</h5>
                    <div class="portfolio-demo">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <strong>Min Portef√∏lje</strong>
                            <span class="badge bg-success">+12.5%</span>
                        </div>
                        {% if demo_portfolio %}
                            {% for stock in demo_portfolio %}
                            <div class="portfolio-item">
                                <div class="d-flex justify-content-between">
                                    <span>{{ stock.ticker }}</span>
                                    <span class="{% if '+' in stock.change %}text-success{% else %}text-danger{% endif %}">{{ stock.change }}</span>
                                </div>
                                <small class="text-muted">{{ stock.shares }} aksjer ‚Ä¢ NOK {{ "{:,.0f}"|format(stock.value) }}</small>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="portfolio-item">
                                <div class="d-flex justify-content-between">
                                    <span>EQUI</span>
                                    <span class="text-success">+8.2%</span>
                                </div>
                                <small class="text-muted">100 aksjer ‚Ä¢ NOK 4,200</small>
                            </div>
                            <div class="portfolio-item">
                                <div class="d-flex justify-content-between">
                                    <span>DNB</span>
                                    <span class="text-danger">-2.1%</span>
                                </div>
                                <small class="text-muted">50 aksjer ‚Ä¢ NOK 8,500</small>
                            </div>
                            <div class="portfolio-item">
                                <div class="d-flex justify-content-between">
                                    <span>TEL</span>
                                    <span class="text-success">+15.7%</span>
                                </div>
                                <small class="text-muted">200 aksjer ‚Ä¢ NOK 3,400</small>
                            </div>
                        {% endif %}
                    </div>
                    <!-- Portfolio demo is now interactive -->
                </div>
            </div>
            
            <div class="col-md-6">
                <div class="demo-widget">
                    <h5 class="text-dark mb-3">üîî Prisvarsler</h5>
                    {% if demo_alerts %}
                        {% for alert in demo_alerts %}
                        <div class="alert {% if alert.type == 'price' %}alert-warning{% elif alert.type == 'volume' %}alert-info{% else %}alert-success{% endif %}">
                            <i class="bi {% if alert.type == 'price' %}bi-bell{% elif alert.type == 'volume' %}bi-activity{% else %}bi-newspaper{% endif %}"></i>
                            <strong>{{ alert.time }}:</strong> {{ alert.message }}
                        </div>
                        {% endfor %}
                    {% else %}
                        <div class="alert alert-warning">
                            <i class="bi bi-bell"></i>
                            <strong>Varsel:</strong> EQUI har n√•dd kursm√•l p√• 42 NOK!
                        </div>
                        <div class="alert alert-info">
                            <i class="bi bi-info-circle"></i>
                            <strong>Info:</strong> DNB rapporterer kvartalstall i morgen
                        </div>
                    {% endif %}
                    <div class="text-center mt-3">
                        <button class="btn btn-sm btn-outline-primary" onclick="alert('Demo: Pr√∏v √• registrere deg for full varsel-funksjonalitet!')">
                            <i class="bi bi-plus"></i> Legg til nytt varsel
                        </button>
                    </div>
                    <!-- Price alerts now functional -->
                </div>
            </div>
        </div>

        <!-- Demo: News & Market Data -->
        <div class="row g-4 mb-5">
            <div class="col-md-6">
                <div class="demo-widget">
                    <h5 class="text-dark mb-3">üì∞ Markedsnyheter</h5>
                    {% if demo_news %}
                        {% for news in demo_news %}
                        <div class="news-item">
                            <h6>{{ news.title }}</h6>
                            <p class="text-muted small">{{ news.summary }}</p>
                            <span class="badge bg-info">{{ news.time }}</span>
                        </div>
                        {% endfor %}
                    {% else %}
                        <div class="news-item">
                            <h6>Oslo B√∏rs √•pner h√∏yt</h6>
                            <p class="text-muted small">Positive signaler fra olje- og gassektoren...</p>
                            <span class="badge bg-info">2 timer siden</span>
                        </div>
                        <div class="news-item">
                            <h6>DNB rapporterer sterke tall</h6>
                            <p class="text-muted small">Banken overg√•r forventningene...</p>
                            <span class="badge bg-info">4 timer siden</span>
                        </div>
                        <div class="news-item">
                            <h6>Equinor kutter utbytte</h6>
                            <p class="text-muted small">Oljeselskapet justerer strategi...</p>
                            <span class="badge bg-info">6 timer siden</span>
                        </div>
                    {% endif %}
                    <!-- Reduced lock overlay for partial functionality -->
                    <!-- News demo is now interactive -->
                </div>
            </div>
            
            <div class="col-md-6">
                <div class="demo-widget">
                    <h5 class="text-dark mb-3">üåç Globale Markeder</h5>
                    <div class="global-markets">
                        {% if global_stocks and global_stocks|length > 0 %}
                            {% for stock in global_stocks[:4] %}
                            <div class="market-item">
                                <span class="flag">ÔøΩ</span>
                                <div class="market-info">
                                    <strong>{{ stock.name or stock.ticker }}</strong>
                                    <span class="{% if (stock.change_percent or 0) >= 0 %}text-success{% else %}text-danger{% endif %}">
                                        {{ "%+.1f"|format(stock.change_percent or 0) }}%
                                    </span>
                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="market-item">
                                <span class="flag">ÔøΩüá∫üá∏</span>
                                <div class="market-info">
                                    <strong>S&P 500</strong>
                                    <span class="text-success">+0.5%</span>
                                </div>
                            </div>
                            <div class="market-item">
                                <span class="flag">üá©üá™</span>
                                <div class="market-info">
                                    <strong>DAX</strong>
                                    <span class="text-danger">-0.3%</span>
                                </div>
                            </div>
                            <div class="market-item">
                                <span class="flag">üáØüáµ</span>
                                <div class="market-info">
                                    <strong>Nikkei</strong>
                                    <span class="text-success">+1.2%</span>
                                </div>
                            </div>
                            <div class="market-item">
                                <span class="flag">üá¨üáß</span>
                                <div class="market-info">
                                    <strong>FTSE 100</strong>
                                    <span class="text-success">+0.7%</span>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                    <!-- Global markets demo is now interactive -->
                </div>
            </div>
        </div>
        
        <div class="text-center mt-5">
            <h3 class="text-dark mb-3">üéØ Klar for √• ta kontrollen over dine investeringer?</h3>
            <p class="text-muted mb-4">Oppgrader til full versjon og f√• tilgang til alle funksjoner</p>
            <div class="d-flex justify-content-center gap-3">
                <a href="{{ url_for('main.subscription') }}" class="btn btn-success btn-lg">
                    <i class="bi bi-star"></i> Se abonnement
                </a>
                <a href="{{ url_for('main.login') }}" class="btn btn-outline-primary btn-lg">
                    <i class="bi bi-box-arrow-in-right"></i> Logg inn
                </a>
            </div>
        </div>
    </div>
</div>

<style>
.hero-section {
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    min-height: 60vh;
    display: flex;
    align-items: center;
    padding: 80px 0;
}

.demo-stat {
    text-align: center;
    padding: 1rem;
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.demo-stat h3 {
    margin-bottom: 0.5rem;
    font-size: 1.5rem;
    font-weight: bold;
}

.demo-stat p {
    margin-bottom: 0;
    font-size: 0.9rem;
}

.feature-card {
    background: white;
    border-radius: 12px;
    padding: 2rem;
    text-align: center;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    transition: transform 0.3s ease;
}

.feature-card:hover {
    transform: translateY(-5px);
}

.feature-icon {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 1rem;
    font-size: 1.5rem;
}

.feature-comparison {
    margin-top: 1rem;
}

.demo-version, .full-version {
    margin-bottom: 0.5rem;
}

.demo-widget {
    background: white;
    border-radius: 12px;
    padding: 1.5rem;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    position: relative;
}

.demo-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(255,255,255,0.9);
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 12px;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.demo-widget:hover .demo-overlay {
    opacity: 1;
}

.demo-lock {
    text-align: center;
    color: #6c757d;
}

.demo-lock i {
    font-size: 2rem;
    margin-bottom: 0.5rem;
}

.demo-preview {
    text-align: center;
}

.analysis-card {
    background: #f8f9fa;
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 1rem;
    text-align: center;
}

.analysis-card h6 {
    margin-bottom: 0.5rem;
    color: #495057;
}

.portfolio-item {
    border-bottom: 1px solid #eee;
    padding: 0.5rem 0;
}

.portfolio-item:last-child {
    border-bottom: none;
}

.news-item {
    border-bottom: 1px solid #eee;
    padding: 1rem 0;
}

.news-item:last-child {
    border-bottom: none;
}

.news-item h6 {
    margin-bottom: 0.5rem;
    color: #495057;
}

.market-item {
    display: flex;
    align-items: center;
    padding: 0.5rem 0;
    border-bottom: 1px solid #eee;
}

.market-item:last-child {
    border-bottom: none;
}

.market-item .flag {
    margin-right: 1rem;
    font-size: 1.2rem;
}

.market-info {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex: 1;
}

.global-markets {
    max-height: 200px;
    overflow-y: auto;
}
</style>

<script>
// Show trial expired banner if coming from trial expiration
document.addEventListener('DOMContentLoaded', function() {
    const urlParams = new URLSearchParams(window.location.search);
    const source = urlParams.get('source');
    
    if (source === 'trial_expired') {
        document.getElementById('trial-banner').style.display = 'block';
    }
});
</script>
{% endblock %}
