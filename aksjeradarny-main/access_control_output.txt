🔐 Starting comprehensive access control testing...
🌐 Base URL: http://localhost:5000


📋 [ 1/9] Testing: Main analysis page
============================================================
🔐 Testing access control for: /analysis
    📝 Main analysis page
    🚫 Testing without authentication...
    🎭 Testing demo user access...
    ⏱️ Testing trial user access...
    ⏰ Testing expired trial user access...
    💎 Testing premium user access...
    ✅ PASSED - Access control working correctly
    ✅ Correct behaviors:
       ✓ Demo user has appropriate access with demo indicators
       ✓ Trial user has access
       ✓ Premium user has full access

📋 [ 2/9] Testing: Portfolio overview
============================================================
🔐 Testing access control for: /portfolio
    📝 Portfolio overview
    🚫 Testing without authentication...
    🎭 Testing demo user access...
    ⏱️ Testing trial user access...
    ⏰ Testing expired trial user access...
    💎 Testing premium user access...
    ❌ ISSUES FOUND:
       🔸 Expired trial user has full access without restrictions
    ✅ Correct behaviors:
       ✓ Demo user has appropriate access with demo indicators
       ✓ Trial user has access
       ✓ Premium user has full access

📋 [ 3/9] Testing: Advanced portfolio features
============================================================
🔐 Testing access control for: /portfolio/advanced
    📝 Advanced portfolio features
    🚫 Testing without authentication...
    ⏱️ Testing trial user access...
    ⏰ Testing expired trial user access...
    💎 Testing premium user access...
    ✅ PASSED - Access control working correctly
    ✅ Correct behaviors:
       ✓ Trial user has access
       ✓ Expired trial correctly shows upgrade prompt or blocks access
       ✓ Premium user has full access

📋 [ 4/9] Testing: Analyst recommendations
============================================================
🔐 Testing access control for: /features/analyst-recommendations
    📝 Analyst recommendations
    🚫 Testing without authentication...
    🎭 Testing demo user access...
    ⏱️ Testing trial user access...
    ⏰ Testing expired trial user access...
    💎 Testing premium user access...
    ❌ ISSUES FOUND:
       🔸 Endpoint accessible without authentication when it should require auth
       🔸 Expired trial user has full access without restrictions
    ✅ Correct behaviors:
       ✓ Demo user has appropriate access with demo indicators
       ✓ Trial user has access
       ✓ Premium user has full access

📋 [ 5/9] Testing: Social sentiment analysis
============================================================
🔐 Testing access control for: /features/social-sentiment
    📝 Social sentiment analysis
    🚫 Testing without authentication...
    ⏱️ Testing trial user access...
    ⏰ Testing expired trial user access...
    💎 Testing premium user access...
    ❌ ISSUES FOUND:
       🔸 Endpoint accessible without authentication when it should require auth
       🔸 Expired trial user has full access without restrictions
    ✅ Correct behaviors:
       ✓ Trial user has access
       ✓ Premium user has full access

📋 [ 6/9] Testing: AI predictions
============================================================
🔐 Testing access control for: /features/ai-predictions
    📝 AI predictions
    🚫 Testing without authentication...
    ⏱️ Testing trial user access...
    ⏰ Testing expired trial user access...
    💎 Testing premium user access...
    ❌ ISSUES FOUND:
       🔸 Endpoint accessible without authentication when it should require auth
       🔸 Expired trial user has full access without restrictions
    ✅ Correct behaviors:
       ✓ Trial user has access
       ✓ Premium user has full access

📋 [ 7/9] Testing: Market intelligence
============================================================
🔐 Testing access control for: /market-intel
    📝 Market intelligence
    🚫 Testing without authentication...
    🎭 Testing demo user access...
    ⏱️ Testing trial user access...
    ⏰ Testing expired trial user access...
    💎 Testing premium user access...
    ❌ ISSUES FOUND:
       🔸 Expired trial user has full access without restrictions
    ✅ Correct behaviors:
       ✓ Demo user has appropriate access with demo indicators
       ✓ Trial user has access
       ✓ Premium user has full access

📋 [ 8/9] Testing: User profile
============================================================
🔐 Testing access control for: /profile
    📝 User profile
    🚫 Testing without authentication...
    🎭 Testing demo user access...
    ⏱️ Testing trial user access...
    ⏰ Testing expired trial user access...
    💎 Testing premium user access...
    ✅ PASSED - Access control working correctly
    ✅ Correct behaviors:
       ✓ Correctly redirects to login when not authenticated
       ✓ Demo user has appropriate access with demo indicators
       ✓ Trial user has access
       ✓ Expired trial correctly shows upgrade prompt or blocks access
       ✓ Premium user has full access

📋 [ 9/9] Testing: User notifications
============================================================
🔐 Testing access control for: /notifications
    📝 User notifications
    🚫 Testing without authentication...
    🎭 Testing demo user access...
    ⏱️ Testing trial user access...
    ⏰ Testing expired trial user access...
    💎 Testing premium user access...
    ✅ PASSED - Access control working correctly
    ✅ Correct behaviors:
       ✓ Demo user has appropriate access with demo indicators
       ✓ Trial user has access
       ✓ Expired trial correctly shows upgrade prompt or blocks access
       ✓ Premium user has full access

============================================================
📊 Access Control Test Summary:
    ✅ Passed: 4
    ❌ Failed: 5
    📈 Success Rate: 44.4%
📄 Access control report saved to: access_control_report.json

⚠️  5 endpoints have access control issues.
